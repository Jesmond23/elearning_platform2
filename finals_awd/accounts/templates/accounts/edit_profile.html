{% extends 'base.html' %}
{% load static %}
{% block title %}Edit Profile{% endblock %}

{% block content %}
<div class="max-w-2xl p-6 mx-auto mt-10 bg-white rounded-lg">
    <h2 class="text-2xl font-bold text-gray-800 mb-6">Edit Your Profile</h2>
    <form method="post" enctype ="multipart/form-data" class="space-y-6">
        {% csrf_token %}

      <!-- Profile Picture Preview -->
<div>
    <label class="block text-sm font-medium text-gray-600 mb-1">Current Picture:</label>
    {% if user.profile_picture %}
        <img id="avatarPreview" src="{{ user.profile_picture.url }}" alt="Profile Picture"
             class="w-24 h-24 rounded-full object-cover border border-gray-300" />
    {% else %}
        <img id="avatarPreview" src="{% static 'default-avatar.png' %}" alt="Default Avatar"
             class="w-24 h-24 rounded-full object-cover border border-gray-300" />
    {% endif %}
</div>

          <!-- File Upload -->
        <div>
            <label for="id_profile_picture" class="block text-sm font-medium text-gray-600">Change Picture:</label>
            <input type="file" name="profile_picture" id="id_profile_picture"
                   accept="image/*"
                   onchange="previewAvatar(event)"
                   class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4
                          file:rounded-md file:border-0 file:text-sm file:font-semibold
                          file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" />
        </div>
    <!--Username-->
    <!-- Username -->
        <div>
            <label for="id_username" class="block text-sm font-medium text-gray-600">Username:</label>
            {{ form.username }}
        </div>

        <!-- First Name -->
        <div>
            <label for="id_first_name" class="block text-sm font-medium text-gray-600">First Name:</label>
            {{ form.first_name }}
        </div>

        <!-- Last Name -->
        <div>
            <label for="id_last_name" class="block text-sm font-medium text-gray-600">Last Name:</label>
            {{ form.last_name }}
        </div>

    <!--Submit -->
    <div class="pt-4">
        <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-800 transition">
            Update
        </button>
    </div>
</form>
</div>
   
<!--Script to dynamically load image-->
<script>
    function previewAvatar(event){
        const reader= new FileReader();
        reader.onload = function(){
            const output = document.getElementById('avatarPreview');
            output.src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>

{% endblock %}